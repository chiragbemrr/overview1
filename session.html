< !DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Session Dropdown</title>
        <style>
            #sessionDropdown {
                width: 250px;
                padding: 5px;
                margin: 20px;
            }

            #sessionData {
                margin - top: 20px;
            }
        </style>
    </head>

    <body>
        <h1>Session Dropdown</h1>

        <!-- Dropdown for selecting session -->
        <select id="sessionDropdown">
            <option value="">Select a session</option>
        </select>

        <!-- Display session data -->
        <div id="sessionData"></div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.1/d3.min.js"></script>
        <script>
            // Function to fetch session data and populate the dropdown
            async function fetchSessions() {
                try {
                    const response = await fetch('/api/emissions/sessions'); // Assuming this is the API URL
                    const sessions = await response.json();

                    const dropdown = document.getElementById('sessionDropdown');
                    // Clear the dropdown and add new options
                    dropdown.innerHTML = '<option value="">Select a session</option>';

                    sessions.forEach((session, index) => {
                        const option = document.createElement('option');
                        option.value = session.sessionStartDate;
                        option.textContent = `Session ${index + 1} - Start: ${new Date(session.sessionStartDate).toLocaleString()}`;
                        dropdown.appendChild(option);
                    });

                    // Add event listener for dropdown change
                    dropdown.addEventListener('change', (event) => {
                        const selectedStartDate = event.target.value;
                        if (selectedStartDate) {
                            const selectedSession = sessions.find(session => session.sessionStartDate === selectedStartDate);
                            displaySessionData(selectedSession);
                        }
                    });
                } catch (error) {
                    console.error('Error fetching sessions:', error);
                }
            }

            // Function to display session data
            function displaySessionData(session) {
                const sessionDataDiv = document.getElementById('sessionData');
                sessionDataDiv.innerHTML = `<h3>Session Details</h3>
                        <p><strong>Session Start Date:</strong> ${new Date(session.sessionStartDate).toLocaleString()}</p>
                        <p><strong>Session End Date:</strong> ${new Date(session.sessionEndDate).toLocaleString()}</p>
                        <ul>
                            ${session.data.map(entry => `
                        <li>Data: ${JSON.stringify(entry)}</li>
                    `).join('')}
                        </ul>
                        `;
            }

            // Initially load the sessions and populate the dropdown
            fetchSessions();

            // Function to simulate adding new sessions (for demo purposes)
            function addNewSession() {
                const newSession = {
                    sessionStartDate: new Date().toISOString(),
                    sessionEndDate: new Date(Date.now() + 3600000).toISOString(),
                    data: [{ CO2: 400, temperature: 23 }, { CO2: 420, temperature: 22 }]
                };

                // For demonstration, push this new session to the dropdown
                const dropdown = document.getElementById('sessionDropdown');
                const option = document.createElement('option');
                option.value = newSession.sessionStartDate;
                option.textContent = `New Session - Start: ${new Date(newSession.sessionStartDate).toLocaleString()}`;
                dropdown.appendChild(option);
            }

            // Call addNewSession function to simulate adding a new session every 10 seconds (for demo purposes)
            setInterval(addNewSession, 10000);  // New session added every 10 seconds

        </script>
    </body>

    </html>